{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,aAGA,MACMC,EADOC,SAASC,cAAc,QACjBC,SAASC,YACtBC,EAAOJ,SAASC,cAAc,YAC9BI,EAASL,SAASC,cAAc,cAChCK,EAASN,SAASC,cAAc,aACtC,IAAIM,EAAc,EAalBC,eAAeC,EAAiBC,GAC9B,IACE,MAAMC,QAAiB,EAAAd,EAAAe,UAASF,EAAOH,GACvC,IAAIM,EAAgC,GAAdN,EACtBH,EAAKU,mBAAmB,cAAc,EAAAC,EAAAC,cAAaL,EAASM,OAC5DC,EAASC,QAAQb,GACbK,EAASS,UAAYP,GACvBQ,QAAQC,IAAI,6D,CAEd,MAAOC,GACPF,QAAQE,MAAMA,E,EAIlBlB,EAAOmB,iBAAiB,SAASC,IAC/BA,EAAMC,iBACN,MAAMC,EAAqCvB,EArBhBwB,iBAAiB,eAE5BC,OAAS,EAoBzB,GAAoB,KAAhB9B,EAAM+B,MACR,OAAOT,QAAQC,IAAI,+BAGrB,GAAIK,EAAiB,CACnBvB,EAAK2B,UAAY,GAEjBtB,EADqBV,EAAM+B,M,KAEtB,CAELrB,EADqBV,EAAM+B,M,KA2B/B,IAAIZ,EAAW,IAAIc,sBAtBnB,SAAgBC,EAASC,GACvBD,EAAQE,SAAQ3B,MAAM4B,IACpB,GAAIA,EAAMC,eAAgB,CACxB,MAAMC,EAAevC,EAAM+B,MAC3BvB,GAAe,EACf,IAAIM,EAAgC,GAAdN,EACtB,IACE,MAAMI,QAAiB,EAAAd,EAAAe,UAAS0B,EAAc/B,GAC9CH,EAAKU,mBAAmB,aAAa,EAAAC,EAAAC,cAAaL,EAASM,OACvDN,EAASS,UAAYP,IACvBqB,EAASK,UAAUjC,GACnBe,QAAQC,IACN,8D,CAGJ,MAAOC,GACPF,QAAQE,MAAMA,E,QA3DR,CACZiB,KAAM,KACNC,WAAY,QACZC,UAAW","sources":["src/js/infiniti.js"],"sourcesContent":["import { getPhoto } from './api';\nimport { createMarkup } from './markup';\n\nconst form = document.querySelector('form');\nconst input = form.elements.searchQuery;\nconst list = document.querySelector('.gallery');\nconst button = document.querySelector('.submitBtn');\nconst target = document.querySelector('.js-guard');\nlet currentPage = 1;\nlet options = {\n  root: null,\n  rootMargin: '300px',\n  threshold: 1.0,\n};\n\nfunction arePicturesPresent(container) {\n  const pictures = container.querySelectorAll('.photo-card');\n\n  return pictures.length > 0;\n}\n\nasync function getGeneralMarkup(input) {\n  try {\n    const pictures = await getPhoto(input, currentPage);\n    let valueOfPictures = currentPage * 40;\n    list.insertAdjacentHTML('afterbegin', createMarkup(pictures.hits));\n    observer.observe(target);\n    if (pictures.totalHits < valueOfPictures) {\n      console.log(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (error) {\n    console.error(error);\n  }\n}\n\nbutton.addEventListener('click', event => {\n  event.preventDefault();\n  const picturesPresent = arePicturesPresent(list);\n  if (input.value === '') {\n    return console.log('please put down correct tag');\n  }\n\n  if (picturesPresent) {\n    list.innerHTML = '';\n    const currentInput = input.value;\n    getGeneralMarkup(currentInput);\n  } else {\n    const currentInput = input.value;\n    getGeneralMarkup(currentInput);\n  }\n});\n\nfunction onLoad(entries, observer) {\n  entries.forEach(async entry => {\n    if (entry.isIntersecting) {\n      const currentInput = input.value;\n      currentPage += 1;\n      let valueOfPictures = currentPage * 40;\n      try {\n        const pictures = await getPhoto(currentInput, currentPage);\n        list.insertAdjacentHTML('beforeend', createMarkup(pictures.hits));\n        if (pictures.totalHits < valueOfPictures) {\n          observer.unobserve(target);\n          console.log(\n            \"We're sorry, but you've reached the end of search results.\"\n          );\n        }\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  });\n}\n\nlet observer = new IntersectionObserver(onLoad, options);\n"],"names":["$7rYDH","parcelRequire","$d974ac970b8ca2b1$var$input","document","querySelector","elements","searchQuery","$d974ac970b8ca2b1$var$list","$d974ac970b8ca2b1$var$button","$d974ac970b8ca2b1$var$target","$d974ac970b8ca2b1$var$currentPage","async","$d974ac970b8ca2b1$var$getGeneralMarkup","input1","pictures","getPhoto","valueOfPictures","insertAdjacentHTML","$3huUq","createMarkup","hits","$d974ac970b8ca2b1$var$observer","observe","totalHits","console","log","error","addEventListener","event","preventDefault","picturesPresent","querySelectorAll","length","value","innerHTML","IntersectionObserver","entries","observer1","forEach","entry","isIntersecting","currentInput","unobserve","root","rootMargin","threshold"],"version":3,"file":"infinity-scrol.7626d682.js.map"}